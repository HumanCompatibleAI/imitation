WARNING - root - Added new config entry: "__doc__"
WARNING - root - Added new config entry: "discrim_net_kwargs.gail.normalize_images"
INFO - train_adversarial - Running command 'train_adversarial'
INFO - train_adversarial - Started run with ID "96"
INFO - root - Logging to 'tests/testdata/reward_models/gail/cartpole_0/n_expert_demos_1'
INFO - root - using GAIL
/home/adam/dev/imitation/venv/lib/python3.7/site-packages/torch/utils/data/_utils/collate.py:64: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /pytorch/torch/csrc/utils/tensor_numpy.cpp:180.)
  return default_collate([torch.as_tensor(b) for b in batch])
INFO - root - Discriminator network summary:
 DiscrimNetGAIL(
  (discriminator): ActObsMLP(
    (mlp): Sequential(
      (dense0): Linear(in_features=6, out_features=32, bias=True)
      (act0): ReLU()
      (dense1): Linear(in_features=32, out_features=32, bias=True)
      (act1): ReLU()
      (dense_final): Linear(in_features=32, out_features=1, bias=True)
    )
  )
)
INFO - root - RL algorithm: <class 'stable_baselines3.ppo.ppo.PPO'>
INFO - root - Imitation (generator) policy network summary:
FeedForward32Policy(
  (features_extractor): FlattenExtractor(
    (flatten): Flatten(start_dim=1, end_dim=-1)
  )
  (mlp_extractor): MlpExtractor(
    (shared_net): Sequential(
      (0): Linear(in_features=4, out_features=32, bias=True)
      (1): Tanh()
      (2): Linear(in_features=32, out_features=32, bias=True)
      (3): Tanh()
    )
    (policy_net): Sequential()
    (value_net): Sequential()
  )
  (action_net): Linear(in_features=32, out_features=2, bias=True)
  (value_net): Linear(in_features=32, out_features=1, bias=True)
)
round:   0%|          | 0/5 [00:00<?, ?it/s]round:  60%|██████    | 3/5 [00:00<00:00, 26.26it/s]round: 100%|██████████| 5/5 [00:00<00:00, 26.70it/s]
INFO - root - Saved policy to tests/testdata/reward_models/gail/cartpole_0/n_expert_demos_1/checkpoints/final/gen_policy
INFO - train_adversarial - Result: {'expert_stats': {'n_traj': 1, 'return_min': 500.0, 'return_mean': 500.0, 'return_std': 0.0, 'return_max': 500.0, 'len_min': 500, 'len_mean': 500.0, 'len_std': 0.0, 'len_max': 500}, 'imit_stats': {'n_traj': 2, 'monitor_return_len': 2, 'return_min': 3.0353928208351135, 'return_mean': 3.0864495635032654, 'return_std': 0.051056742668151855, 'return_max': 3.1375063061714172, 'len_min': 5, 'len_mean': 5.0, 'len_std': 0.0, 'len_max': 5, 'monitor_return_min': 5.0, 'monitor_return_mean': 5.0, 'monitor_return_std': 0.0, 'monitor_return_max': 5.0}}
INFO - train_adversarial - Completed after 0:00:00
